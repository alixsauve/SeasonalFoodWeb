rm(list=ls(all=TRUE))
# define directories
DAT_DIR <- "../../Data/ProcessedData"
# load densities
setwd(DAT_DIR)
SpDensities <- read.csv("SpDensitySeasons_1.csv", header = TRUE, stringsAsFactors = FALSE)
PreyList <- sort(SpDensities$Taxon[SpDensities$Trophic_level == "Prey"])
PredList <- sort(SpDensities$Taxon[SpDensities$Trophic_level == "Predator"])
# verify order of species
SpDensities <- SpDensities[match(c(PredList, PreyList), SpDensities$Taxon),]
# convert all densities to N/ha
# spring
IndexUnit2Change <- ((SpDensities$Unit_Spring_density == "N/km2") & (!is.na(SpDensities$Unit_Spring_density)))
if (any(IndexUnit2Change)){
SpDensities$Spring_density[IndexUnit2Change] <- SpDensities$Spring_density[IndexUnit2Change]/100
SpDensities$Unit_Spring_density[IndexUnit2Change] <- "N/ha"
}
# summer
IndexUnit2Change <- ((SpDensities$Unit_Summer_density == "N/km2") & (!is.na(SpDensities$Unit_Summer_density)))
if (any(IndexUnit2Change)){
SpDensities$Summer_density[IndexUnit2Change] <- SpDensities$Summer_density[IndexUnit2Change]/100
SpDensities$Unit_Summer_density[IndexUnit2Change] <- "N/ha"
}
# autumn
IndexUnit2Change <- ((SpDensities$Unit_Autumn_density == "N/km2") & (!is.na(SpDensities$Unit_Autumn_density)))
if (any(IndexUnit2Change)){
SpDensities$Autumn_density[IndexUnit2Change] <- SpDensities$Autumn_density[IndexUnit2Change]/100
SpDensities$Unit_Autumn_density[IndexUnit2Change] <- "N/ha"
}
# winter
IndexUnit2Change <- ((SpDensities$Unit_Winter_density == "N/km2") & (!is.na(SpDensities$Unit_Winter_density)))
if (any(IndexUnit2Change)){
SpDensities$Winter_density[IndexUnit2Change] <- SpDensities$Winter_density[IndexUnit2Change]/100
SpDensities$Unit_Winter_density[IndexUnit2Change] <- "N/ha"
}
# year
IndexUnit2Change <- ((SpDensities$Unit_Mean_density == "N/km2") & (!is.na(SpDensities$Unit_Mean_density)))
if (any(IndexUnit2Change)){
SpDensities$Mean_density[IndexUnit2Change] <- SpDensities$Mean_density[IndexUnit2Change]/100
SpDensities$Unit_Mean_density[IndexUnit2Change] <- "N/ha"
}
# for our estimates of attack rates, we need winter densities
# here we make a couple of hypotheses to complete this dataset for prey abundances during winter
# for which clades are we missing information?
Clades_MissingWinterAbund <- unique(SpDensities$Clade[(is.na(SpDensities$Winter_density)) & (SpDensities$Trophic_level == "Prey")])
# for amphibians, rodents, shrews, we assume spring densities are pretty much the same as winter's
SpDensities$Winter_density[(is.na(SpDensities$Winter_density)) & (SpDensities$Trophic_level == "Prey")] <- SpDensities$Spring_density[(is.na(SpDensities$Winter_density)) & (SpDensities$Trophic_level == "Prey")]
# remove winter densities for migratory birds
SpDensities$Winter_density[SpDensities$IsMigratoryBird] <- NA
SpDensities$Unit_Winter_density[SpDensities$IsMigratoryBird] <- NA
# add another column to group species within less groups
head(SpDensities)
unique(SpDensities$CladeBis)
